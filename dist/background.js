(()=>{let t="idle",e=[],s=!1;async function c(){try{const t=await fetch("http://localhost:8000/auth/check",{credentials:"include"});return s=t.ok,t.ok}catch(t){return console.error("Auth check failed:",t),s=!1,!1}}function n(){e.forEach((e=>{e.postMessage({type:"STATUS_UPDATE",status:t})}))}chrome.tabs.onUpdated.addListener((async(t,e,s)=>{"complete"===e.status&&s.url?.includes("meet.google.com")&&await c()&&await async function(t){try{await chrome.scripting.executeScript({target:{tabId:t},func:()=>{const t=document.createElement("script");t.src="http://localhost:8000/content-scripts/meet-injector.js",document.head.appendChild(t)}})}catch(t){console.error("Content script injection failed:",t)}}(t)})),chrome.runtime.onConnect.addListener((s=>{"meet-bot-port"===s.name&&(e.push(s),s.onMessage.addListener((async e=>{if("GET_STATUS"===e.type){if(!await c())return void s.postMessage({type:"AUTH_REQUIRED"});s.postMessage({type:"STATUS_UPDATE",status:t})}else"SET_STATUS"===e.type&&(t=e.status,n())})),s.onDisconnect.addListener((()=>{e=e.filter((t=>t!==s))})))})),chrome.runtime.onMessage.addListener(((e,s,c)=>("GET_STATUS"===e.type?c({status:t}):"SET_STATUS"===e.type&&(t=e.status,n(),c({success:!0})),!0)))})();